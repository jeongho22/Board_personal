

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>User Table</title>
    <!-- 부트스트랩 CSS 추가 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-5">
    <h2>User Table</h2>
    <table class="table table-striped table-hover">
        <thead class="thead-dark">
        <tr>
            <th>이름</th>
            <th>ID</th>
            <th>회원탈퇴</th>
        </tr>
        </thead>
        <tbody id="userTableBody">
        <!-- 자바스크립트를 통해 여기에 사용자 데이터와 삭제 버튼이 동적으로 삽입됩니다. -->
        </tbody>
    </table>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch('/api/users')
            .then(response => response.json())
            .then(users => {
                const tbody = document.getElementById('userTableBody');
                users.forEach(user => {


                    const tr = document.createElement('tr');
                    const tdUsername = document.createElement('td');
                    const tdEmail = document.createElement('td');
                    const tdActions = document.createElement('td');
                    const deleteButton = document.createElement('button');





                    tdUsername.textContent = user.username;
                    tdEmail.textContent = user.email;


                    deleteButton.textContent = '강퇴';
                    deleteButton.className = 'btn btn-danger';
                    deleteButton.setAttribute('data-id', user.id); // 사용자 ID를 버튼에 설정


                    deleteButton.onclick = function() {
                        const userId = this.getAttribute('data-id');
                        const confirmDelete = confirm('정말로 강퇴하시겠습니까?');
                        if (confirmDelete) {
                            deleteUser(userId);
                        }
                    };


                    tdActions.appendChild(deleteButton);
                    tr.appendChild(tdUsername);
                    tr.appendChild(tdEmail);
                    tr.appendChild(tdActions);
                    tbody.appendChild(tr);


                });
            })
            .catch(error => console.error('Error:', error));

        function deleteUser(userId) {
            fetch(`/api/users/${userId}`, {
                method: 'DELETE',
            })
                .then(response => {
                    if (response.ok) {
                        console.log('User deleted successfully');
                        location.reload(); // 페이지 새로고침하여 변경사항 반영
                    } else {
                        console.error('Error deleting user');
                    }
                })
                .catch(error => console.error('Error deleting user', error));
        }
    });




</script>
</body>
</html>
